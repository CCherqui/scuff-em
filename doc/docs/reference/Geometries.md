# Geometry Descriptions in scuff-EM

Geometries in [[scuff-em]] are described by simple text files 
that are conventionally given the file extension ``.scuffgeo.`` 
The ``.scuffgeo`` file format supports a variety of options for 
specifying scattering geometries.

The simplest case is one in which you have a collection of
compact homogeneous objects (which may be nested inside 
one another). In this case, your ``.scuffgeo`` 
file will simply specify mesh files representing the 
surfaces of these objects, as well as optional material
specifications for the frequency-dependent electrical properties
of the media inside.

A *mesh* is a collection of flat triangular panels that 
approximates a two-dimensional surface.
[[scuff-em]] doesn't do the meshing for you;
you use external meshing software such as 
[[gmsh]](http://geuz.org/gmsh) or 
[[comsol](http://www.comsol.com)

In more complicated cases, it may not be possible to
describe your geometry as a simple collection of
objects. This is true, for example, if your geometry 
contains any *multi-material junctions* -- that is, 
points at which three or more disparate media meet.
In this case your ``.scuffgeo`` file will specify 
a series of three-dimensional *regions* and a set of 
two-dimensional meshed *surfaces* lying between them.

Finally, your geometry may be infinitely *extended* -- such 
as a planar metamaterial array, or an infinite square lattice of 
spheres. In this case, your ``.scuffgeo`` file will
specify *lattice vectors* together with a description
of the objects, or the regions and surfaces, that constitute
the *unit-cell* geometry.

<p>
In what follows we will see how to write ``.scuffgeo``
files that describe each of these types of geometries.

    <p>
    <table align="center" class="TOC" cellpadding="5" cellspacing="5">

      <tr> <th> Geometry Files in [[scuff-em]]
      </th></tr>

      <tr> <td>
           <a href="scuff-EM/reference/scuffEMGeometries.shtml#CompactGeometries">
            1. Simple geometries: One or more compact objects (possibly nested)
           </a>
           </td>
      </tr>

      <tr> <td>
           <a href="scuff-EM/reference/scuffEMGeometries.shtml#MultiMaterialJunctions">
            2. More complex geometries: multi-material junctions
           </a>
           </td>
      </tr>

      <tr> <td>
           <a href="scuff-EM/reference/scuffEMGeometries.shtml#ExtendedGeometries">
            3. Extended geometries: periodic boundary conditions
           </a>
           </td>
      </tr>

      <tr> <td>
           <a href="scuff-EM/reference/scuffEMGeometries.shtml#Syntax">
            4. ``.scuffgeo`` file syntax reference
           </a>
           </td>
      </tr>

      <tr> <td>
           <a href="scuff-EM/reference/scuffEMGeometries.shtml#Examples">
            5. A compendium of sample ``.scuffgeo`` files
           </a>
           </td>
      </tr>

    </table>

    <!---------------------------------------------------------------------->
    <!---------------------------------------------------------------------->
    <!---------------------------------------------------------------------->
    <p>
    <h2><a name="CompactGeometries"></a> 1. Simple Geometries: One or more compact objects (possibly nested)
    </h2>
    <hr>

    <p> 
    The simplest [[scuff-em]] geometries consist of 
    one or more *compact objects* -- that is, finite volumes of homogeneous media,
    bounded by closed 2D surfaces. In this case, all meshed surfaces in the geometry 
    must be *closed* surfaces, and no two object surfaces may touch or overlap.
    Each surface is then associated with a single homogeneous material region  -- namely, 
    the region interior to that surface -- and we collectively refer to that material 
    region and its closed surface as an *object.*

    <p> 
    The ``.scuffgeo`` file for geometries of this type consists simply 
    of a sequence of *object declarations*, one for each compact object 
    in the geometry. A typical object declaration section looks something 
    like this:

    <p> 
    <pre class="listing">
  OBJECT UpperSphere
  	MESHFILE Sphere_458.msh
  	MATERIAL Gold
  	DISPLACED 0 0 3
  	ROTATED 45 ABOUT 0 0 1
  ENDOBJECT
    </pre>

    <p> 
    The string that follows the ``OBJECT`` keyword 
    (``UpperSphere`` in this case) is an arbitrary 
    user-specified label that you may attach to your object
    for ease of identifying it in output files, etc. 

    <p> 
    The only keyword that is strictly required within the 
    ``OBJECT...ENDOBJECT`` clause is
    ``MESHFILE.`` This specifies a mesh file, 
    generated by [[gmsh]],
    [[comsol]], or other meshing tools,
    describing the surface of your object. 
    [[scuff-em]] will look for this 
    file in several places: 

    <p> 
      <ul>
      <li> the current working directory
      <li> the directory specified by 
           the ``SCUFFMESHPATH`` environment 
           variable
      <li> any search directories specified using the 
           ``MESHPATH`` keyword in the ``.scuffgeo``
           file.
      </ul>
    <p> The latter two options allow you to set up one or more common 
    repositories of mesh files which you can then re-use for 
    [[scuff-em]] calculations 
    launched from whatever directory you like.

    <p> 
    The optional ``MATERIAL`` keyword is used to select a  
    <a href="scuff-em/reference/scuffEMMaterials.shtml">
    [[scuff-em]] material designation</a>
    (in this case, ``Gold``) for the medium interior to 
    your object. The actual definition of the material ``Gold``
    (given by a ``MATERIAL...ENDMATERIAL`` clause)
    may be present in the ``.scuffgeo`` file before the 
    ``OBJECT`` specification, or may exist in a separate 
    material database file. If you don't specify a ``MATERIAL``
    for your object, it will be treated as a perfectly electrically 
    conducting (PEC) body. 

    <p> 
    The optional ``DISPLACED`` and ``ROTATED``
    keywords specify geometrical transformations 
    that are applied to the surface mesh after it is read in from 
    the mesh file. For example, if your mesh file describes a sphere 
    centered around the origin, and you include the line 
    ``DISPLACED 0 0 3`` in your ``OBJECT...ENDOBJECT``
    clause, then your geometry as interpreted by 
    [[scuff-em]] will contain a sphere
    centered around the point with cartesian coordinates 
    (0,0,3). For more details, see the 
    <a href="scuff-EM/reference/scuffEMGeometries.shtml#Syntax">syntax reference</a>
    below.

    <p> 
    Your ``.scuffgeo`` file may contain any number of
    ``OBJECT...ENDOBJECT`` clauses.
    The objects specified by these clauses may be *nested*,
    i.e. one object may be fully contained inside another 
    object; this will be autodetected by [[scuff-em]].

    <p> 
    (However, this simple way of specifying geometries has 
     the constraint that no two object surfaces may touch or intersect. 
     If you find yourself needing to describe geometries involving 
     objects whose surface touch (thus defining *multi-material junctions*),
     you have graduated to writing the 
     <a href="scuff-em/reference/scuffEMGeometries.shtml#MultiMaterialJunctions">
     slightly more complicated type of ``.scuffgeo`` file</a> described
     below.

    <p> 
    Here's an example of a simple ``.scuffgeo`` file describing 
    a smaller PEC sphere embedded inside a larger silicon dioxide
    sphere.

    <p>
    <table align="center" border="1">
    <tr>
      <th> The geometry</th>
      <th> The ``.scuffgeo`` file </th>
    </tr>
    <tr>
      <td>
      <a href=scuff-em/scuff-scatter/SphericalShell.png>
      <img src="scuff-em/scuff-scatter/SphericalShell.png"></a>
      </td>
     <!---------------------------------------------------->
      <td>
      <pre class="Listing">
 # material specification for intrinsic silicon
 MATERIAL SILICON
     epsf = 1.035;      # \epsilon_infinity
     eps0 = 11.87;      # \epsilon_0 
     wp = 6.6e15;       # \plasmon frequency
     Eps(w) = epsf + (eps0-epsf)/(1-(w/wp)^2);
 ENDMATERIAL


 OBJECT SiliconSphere 
     MESHFILE Sphere_R1P0.msh
     MATERIAL Silicon
 ENDOBJECT 
 
 
 OBJECT InnerSphere 
     MESHFILE Sphere_R0P5.msh
     MATERIAL PEC
 ENDOBJECT 
      </pre>
      </td>
    <tr>
    </table>

    <p> 
    Note that the ``MATERIAL PEC`` specification for the 
    inner sphere is actually superfluous -- we could simply have 
    omitted it, because PEC is the default material assumed for 
    ``OBJECT`` clauses. On the other hand, if we had 
    instead said ``MATERIAL Vacuum``, then we would be 
    describing an *vacuum* sphere inside our larger 
    silicon sphere -- that is, a spherical *shell* of silicon,
    as considered in 
    <a href="scuff-em/scuff-scatter/index.shtml#SphericalShell">this 
    [[scuff-scatter]] example.</a>

    <!----------------------------------------------------------------------> 
    <!---------------------------------------------------------------------->
    <!---------------------------------------------------------------------->
    <p>
    <br>
    <p>
    <h2><a name="MultiMaterialJunctions"></a> 2. More complex geometries: multi-material junctions
    </h2>
    <hr>
 
    <p>
    The attempt to describe a geometry simply as a collection of compact objects 
    breaks down for more complicated situations. For example, consider the composite 
    sphere (or "bihemisphere") depicted in the figure below; this is a spherical
    object formed by adjoining an upper hemisphere of material A to a lower 
    hemisphere of material B. 

    <p>
    <table align="center" border="1" cellspacing="1" cellpadding="1">
     <tr>
      <td><img width="536" height="447" src="scuff-EM/reference/GeometryExamples/BiHemisphere.png"></td>
      <td><img width="485" height="742" src="scuff-EM/reference/GeometryExamples/BiHemisphereMesh.png"></td>
     </tr>
     <tr>
       <th width="536"> Schematic depiction of a Bihemisphere </th>
       <th width="485"> Mesh representations of the three interface surfaces

                        <br>

                        (shown displaced for clarity)
       </th>
     </tr>
    </table>

    <p>
    Our first thought might be to think of the upper hemispherical volume as one 
    compact object, and the lower hemispherical volume as a second compact object.
    But this doesn't work, because we can't assign a unique closed surface to each
    compact object. Clearly the upper hemispherical surface "belongs" to object 
    ``UpperHemisphere,`` and the lower hemispherical surface "belongs" to
    object ``LowerHemisphere.`` But to which volume do we assign the surface 
    of the equatorial plane?

    <p>
    More formally, the key aspect of the bihemisphere geometry that prevents 
    it from being describable as a collection of compact objects is the presence
    of *multi-material junctions* -- that is, regions of the geometry 
    at which three or more homogeneous material regions meet. The equator of 
    the bihemisphere is a multi-material junction. 

    <p>
    (A note on terminology: In 
    [[scuff-em]] parlance,
    a multi-material junction (MMJ) is a point or line 
    at which *three or more* homogeneous regions meet.
    Of course any meshed surface in a geometry -- including 
    the closed surfaces used to describe simple compact-object 
    geometries above -- lies at the junction of
    at least *two* regions, and is thus technically 
    a "multi-material" junction, but is not considered 
    an MMJ for the purposes of the present discussion.)

    <p>
    Geometries involving multi-material junctions are described in 
    [[scuff-em]] by explicitly 
    specifying the various *regions* and *surfaces* 
    that are present. Each *region* is a contiguous volume 
    throughout which the material properties are spatially constant.
    Each *surface* is a mesh describing a closed *or open* 
    2D surface represented as a 
    union of flat triangular panels. Each surface must lie at the 
    interface between precisely two regions.

    <p>
    For example, in the bihemisphere geometry, there are three 
    regions: 

    <p>
     <ol><p> <li> The exterior medium (vacuum).
         <p> <li> The upper hemispherical volume (material A).
         <p> <li> The lower hemispherical volume (material B).
     </ol>
    <p>

    <p>
    And there are three surfaces:

    <p>
     <ol><p> <li> The upper hemispherical surface, which is an interface
                  between regions 1 and 2.
         <p> <li> The lower hemispherical surface, which is an interface
                  between regions 1 and 3.
         <p> <li> The surface of the equatorial plane, which is an 
                  interface between regions 2 and 3.
     </ol>

    <p>
    The ``.scuffgeo`` file for geometry described
    using regions and surfaces will consist, unsurprisingly,
    of ``REGION`` lines and 
    ``SURFACE...ENDSURFACE`` clauses.

    <p>
    Each ``REGION`` line should look something like this:

    <p>
    <pre class="Listing">
  REGION UpperHemisphereVolume MATERIAL Gold
    </pre>

    <p>
    The string identifier following the ``REGION`` keyword is an 
    arbitrary label you may assign to your region. The string identifier
    following the ``MATERIAL`` keyword is a 
    <a href="scuff-em/reference/scuffEMMaterials.shtml">
    [[scuff-em]] material designation
    </a> specifying the frequency-dependent material properties 
    of the region.

    <p>
    All [[scuff-em]] geometries by default
    start off with an implicitly defined region
    named ``Exterior``, of material ``VACUUM``.
    If you want to change the material properties of the 
    exterior medium -- for example, if your entire scattering geometry
    is embedded in ethanol -- you can say something like 

    <p>
    <pre class="Listing">
  REGION Exterior MATERIAL Ethanol
    </pre>

    <p>
    Otherwise, you can refer freely to the region named 
    ``Exterior`` without defining it, as it will 
    be automatically present in all [[scuff-em]]
    geometries.

    <p>
    Surfaces in a regions-and-surfaces geometry are identified 
    by ``SURFACE...ENDSURFACE`` clauses.
    These are similar to ``OBJECT...ENDOBJECT`` 
    clauses, but with a couple of differences. A typical 
    example looks like this:
    
    <p>
    <pre class="Listing">
SURFACE UpperHemisphereSurface
	MESHFILE UpperHemisphereSurface.msh
	REGIONS Exterior UpperHemisphereVolume
ENDSURFACE
    </pre>

    <p>
    The string identifier following the ``SURFACE`` keyword
    is an arbitrary label you may assign to your surface to 
    help identify it in output files, etc.

    <p>
    The mandatory ``MESHFILE`` keyword specifies the 
    name of a file from which [[scuff-em]]
    will attempt to read the surface mesh.

    <p>
    The mandatory ``REGIONS`` keyword identifies the two 
    regions that lie on the two sides of the surface.
    These should be regions that were previously declared using 
    ``REGION`` statements (with the exception of the
    region ``Exteror``, which is always implicitly 
    present.)

    <p>
    The *order* in which you specify surfaces is 
    important for the internal workings of [[scuff-em]],
    although most output quantities reported by most 
    [[scuff-em]] codes will not depend on 
    this ordering.

    The distinction is this: The surface normal vector is taken to 
    point *into* the first region specified with the 
    ``REGIONS`` keyword, and thus *away from* the second
    region. What this means internally is that surface currents on 
    the surface contribute to the fields in the first region with a 
    *positive* sign, and to the fields in the second region 
    with a *negative* sign. Again, however, this is all handled 
    consistently within the internal workings of the code, so flipping
    the order in the ``REGION`` specification should not
    lead to any differences in physically relevant output quantities.
    (If you flip the order of the regions, the currents on the surface
     change sign, and their contributions to the fields in each region
     change sign, so the fields don't change.)

    <p>
    In addition to the mandatory ``MESHFILE`` 
    and ``REGIONS`` keyword, the ``SURFACE...ENDSURFACE``
    may also include ``DISPLACED`` and/or ``ROTATED``
    statements to apply geometrical transforms to your surface,
    as is possible in ``OBJECT...ENDOBJECT`` clauses.

    <p>
    Note that any geometry that may be represented in the simpler
    form discussed above (as a sequence of ``OBJECT...ENDOBJECT``
    clauses) may also be represented in the regions-and-surfaces 
    language. 
    A compact object consists of a single region (the interior of 
    the object) and a single surface (lying at the interface between
    the interior and exterior regions). Thus, if the meshfile 
    ``MySphere.msh`` represents a meshed sphere, then the 
    following two ``.scuffgeo`` files are equivalent:

    <p>
    <table border="1" cellspacing="1" cellpadding="1" align="center">
    <tr>
     <td>
     <pre class="listing">
 REGION SphereInterior MATERIAL Gold

 SURFACE TheSphere
   MESHFILE Sphere.msh
   REGIONS  Exterior SphereInterior
 ENDSURFACE
     </pre>
     </td>

     <td width="10%"> </td>

     <td>
     <pre class="listing">

 OBJECT TheSphere
   MESHFILE Sphere.msh
   MATERIAL Gold
 ENDSURFACE

     </pre>
     </td>
    </tr>
    </table>

    <p>
    (And see <a href="scuff-em/reference/scuffEMGeometries.shtml#NestedSpheres">below</a>
     for an example of how to rewrite the nested-spheres example from above
     in the regions-and-surfaces language.)

    <p>
    In some cases it may be convenient to write a single meshfile
    that contains mesh descriptions for multiple surfaces 
    in your geometry. This may be done by including a
    ``MESHTAG`` specification in your 
    ``SURFACE...ENDSURFACE`` clause:
    
    <p>
    <pre class="Listing">
SURFACE MySurface
	MESHFILE MyMeshFile.msh
	MESHTAG 12
	REGIONS MyRegion1 MyRegion2
ENDSURFACE
    </pre>

    <p>
    What this does is to instruct [[scuff-em]] to
    read from ``MyMeshFile.msh`` only those triangular panels
    that have been tagged by the meshing program as belonging to entity 12. 
    (Different meshing programs have different ways of tagging mesh 
     entities. In [[gmsh]], the tag corresponds to
     what [[gmsh]] calls the "physical region;"
     it is the argument that enters statements
     such as ``Physical Surface(12)={...}`` in the ``.geo``
     file, and it is the number printed as the *``physical-number``*
     field in the ``.msh`` output file.)
    
    <p>
    As an example, here's a ``.scuffgeo`` file for the bihemisphere 
    geometry described above. The meshfile ``BiHemisphere_126.msh``
    was produced by a [[gmsh]] file named 
    <a href="scuff-EM/reference/GeometryExamples/BiHemisphere.geo">
    ``BiHemisphere.geo``</a>;
    note that the three separate interface surfaces
    are created with three separate ``Physical Surface``
    commands, each specifying a different tag, which is then used 
    in the ``.scuffgeo`` file below to distinguish different 
    entities in the ``.msh`` file.

    <p>
    <pre class="Listing">
REGION Exterior        MATERIAL VACUUM
REGION UpperHemisphere MATERIAL CONST_EPS_20
REGION LowerHemisphere MATERIAL CONST_EPS_2

SURFACE LowerHemisphereSurface 
	MESHFILE BiHemisphere_126.msh
	MESHTAG 1
	REGIONS	Exterior LowerHemisphere
ENDSURFACE

SURFACE UpperHemisphereSurface 
	MESHFILE BiHemisphere_126.msh
	MESHTAG 2
	REGIONS	Exterior UpperHemisphere
ENDSURFACE

SURFACE EquatorialPlane
	MESHFILE BiHemisphere_126.msh
	PHYSICAL_REGION 3
	REGIONS	UpperHemisphere LowerHemisphere
ENDSURFACE

    </pre>

    <!---------------------------------------------------------------------->
    <!---------------------------------------------------------------------->
    <!---------------------------------------------------------------------->
    <p>
    <br>
    <p>
    <h2><a name="ExtendedGeometries"></a> 3. Extended geometries: periodic boundary conditions
    </h2>
    <hr>
 
    <p>
    [[scuff-em]] can handle geometries that are
    infinitely extended (that is, periodically repeated) in one or two
    dimensions using Bloch-periodic boundary conditions. In this case,
    your ``.scuffgeo`` file will contain a specification of 
    the objects, or the surfaces and regions, that constitute the 
    *unit-cell* geometry, together with a specification of the 
    *lattice vectors* that describe how the unit cell is periodically
    repeated.

    <blockquote>
    <p style="font-size:smaller;">
    The version 1.0 release of [[scuff-em]] 
    requires that lattice basis vectors must have vanishing *z*
    component -- in other words, the unit cell may be periodically
    repeated in the *x* and/or *y* directions, but not 
    the *z* direction. This places no restrictions on the 
    actual geometric configurations that may be treated, but 
    may be inconvenient for some users who are accustomed to 
    setting up their periodic geometries in a different way.
    (For example, if you are studying thin films, and you are 
    used to having the film surfaces parallel to the *yz*
    plane with the film thickness in the *x* direction, you will
    need to rotate your coordinate system so that the surfaces 
    are parallel to the *xy* plane and the thickness is in 
    the *z* direction.) This limitation may be lifted in 
    a future code release.
    </blockquote>

    <p>
    The lattice is specified using a ``LATTICE...ENDLATTICE``
    section. For example, a square lattice with lattice constant 
    of 1 &mu;m would look like this: 

    <p>
    <pre class="Listing">
 LATTICE
   VECTOR 1 0 
   VECTOR 0 1 
 ENDLATTICE 
    </pre>

    <p>
    Each ``VECTOR xx yy`` statement adds a new lattice vector
    with cartesian components of ``(xx,yy)`` length units.

    <p>
    You may specify one or two ``VECTOR`` statements.
    If you specify a single ``VECTOR``, your unit-cell
    geometry will be periodically repeated in just that one direction.
    If you specify two ``VECTOR`` statements, your unit-cell
    geometry will be periodically repeated in a two-dimensional lattice
    pattern.

    <p>
    Having specified the lattice vectors, the remainder of your 
    ``.scuffgeo`` file just consists of a specification of 
    the unit-cell geometry as if it were a standalone compact 
    geometry. For example, you may include  
    ``OBJECT...ENDOBJECT`` sections to describe any compact
    objects that exist inside the unit cell, or 
    or ``REGION`` statements and ``SURFACE...ENDSURFACE``
    sections to describe more complicated unit-cell geometries.

    <p>
    <h3>*Compact objects fully contained in the unit cell*</h3>

    <p>
    The simplest case is that in which your geometry is simply 
    an array of isolated compact objects (with "isolated" here meaning 
    that each object does not touch its periodically repeated images.)
    In this case, you will want to make sure that the objects 
    lie entirely within the unit cell (not straddling its boundaries),

    For example, here's a ``.scuffgeo`` file describing
    a square lattice of cubical nanoparticles:

    <p>
   <table align="center" border="1" cellspacing="5" cellpadding="5">
   <tr>
    <th> The unit cell geometry </th>
    <th> The innermost 25 cells of the full geometry</th>
   </tr>
   <tr>
    <td><img src="scuff-em/reference/GeometryExamples/CubeUnitCell.png"></td>
    <td rowspan=3><img src="scuff-em/reference/GeometryExamples/CubeLattice.png"></td> 
   </tr> 
   <tr> 
    <th> The ``.scuffgeo`` file </th>
   </tr>
   <tr>
    <td><pre class="Listing">
 LATTICE
   VECTOR 0.5  0
   VECTOR 0.0  0.5
 ENDLATTICE 

 OBJECT CubicalNanoparticle
   MESHFILE Cube.msh
   MATERIAL Silicon
 ENDOBJECT
    </pre></td>
    </tr>
   </table>

    <p>
    <h3>*Surfaces that straddle the unit-cell boundary*</h3>

    <p>
    More generally, your unit-cell geometry may include surfaces 
    that straddle the unit-cell boundary. (This will be the case 
    whenever the infinite surfaces you are describing are 
    *connected*, as opposed to the isolated arrays of objects
    considered above). For example, here's ``.scuffgeo``
    file representing a thin metallic film perforated by an 
    array of holes. The parameters here are chosen to mimic  
    the geometry studied by 
    <a href="http://prl.aps.org/abstract/PRL/v86/i6/p1114_1">
    Martin-Moreno et al, *Physical Review Letters* **86** 1114 (2001).</a>

   <p>
   <table align="center" border="1" cellspacing="5" cellpadding="5">
   <tr>
    <th> The unit cell geometry </th>
    <th> The innermost 25 cells of the full geometry</th>
   </tr>
   <tr>
    <td><img width="629" src="scuff-EM/scuff-transmission/PTFUnitCell1.png"></td>
    <td rowspan=3><img width="638" src="scuff-EM/scuff-transmission/PTFLattice.png"></td> 
   </tr> 
   <tr> 
    <th> The ``.scuffgeo`` file </th>
   </tr>
   <tr>
    <td><pre class="Listing">
 LATTICE
   VECTOR 0.75  0
   VECTOR 0.0   0.75
 ENDLATTICE 

 OBJECT UnitCellMesh
   MESHFILE PFT_794.msh
   MATERIAL Gold
 ENDOBJECT
    </pre></td>
    </tr>
   </table>

    <!---------------------------------------------------------------------->
    <!---------------------------------------------------------------------->
    <!---------------------------------------------------------------------->
    <p>
    <h4>*Meshing constraints for surfaces that straddle the unit-cell boundary*</h4>

    <p>
    There is an important constraint on the surface meshes that may be  
    used to define the unit-cell geometry for problems involving continuous
    symmetries.

    <p>
    The constraint is this: <i>For any panel edge that lies on a unit-cell 
    boundary, there must be an identical edge lying on the opposite 
    side of the unit-cell boundary.</i> One way to think about this is 
    that the periodically-repeated images of the unit-cell geometry must 
    all fit together "nicely" at the unit-cell boundaries, as indicated 
    in the right panel of the figure above.

    <!---------------------------------------------------------------------->
    <!---------------------------------------------------------------------->
    <!---------------------------------------------------------------------->
    <p>
    <br>
    <p>
    <h2><a name="Syntax"></a> 4. Syntax reference for the ``.scuffgeo``
                              file format
    </h2>
    <hr>

    <p>
    The ``.scuffgeo`` consists of one or more *sections*
    plus possibly a number of simple specifications that only occupy
    a single line.

    <p>
    Blank lines and comments (lines beginning with a ``#`` symbol)
    are ignored in ``.scuffgeo`` files.

    <p>
    <ul>
      <p>
      <li> <h3> ``MESHPATH`` definition</h3>

         <table width="75%" align="center" border="1" cellpadding="5" cellspacing="5">
     
         <tr> <th width="200"> Keyword </th> 
              <th> Description </th> 
         </tr>
      
         <tr> 
            <td> ``MESHPATH`` ***my-mesh-path***</td>
            <td> Adds the directory *my-mesh-path* to the list of 
                 directories searched by [[scuff-em]]
                 for mesh files. Your ``.scuffgeo`` file may 
                 contain any number of ``MESHPATH`` specifications.
            </td>
         </tr> 
         </table>

      <li> <h3> ``OBJECT...ENDOBJECT`` sections</h3>

         <table width="75%" align="center" border="1" cellpadding="5" cellspacing="5">
     
         <tr> <th width="200"> Keyword </th> 
              <th> Description </th> 
         </tr>
      
         <tr> 
            <td> ``OBJECT`` ***object label***</td>
            <td> Begins an object declaration for an object with the specified
                 label.
            </td>
         </tr> 
     
         <tr> 
            <td> ``DISPLACED`` ***xx yy zz***</td>
            <td> Indicates that the contents of the specified mesh 
                 file are to be translated through a displacement vector with 
                 cartesian components (***xx, yy, zz***) before
                 inclusion in the geometry.
            </td>
         </tr>
     
         <tr> 
            <td> ``ROTATED`` ***dd*** `` ABOUT `` ***nx ny nz***</td>
            <td> Indicates that the contents of the specified mesh 
                 file are to be rotated through an angle of ***dd***
                 degrees (**not radians**) about an axis passing through the origin
                 and through the point with cartesian coordinates
                 (***nx, ny, nz***) before inclusion in the geometry.
            </td>
         </tr> 
      
         <tr> 
            <td> ``ENDOBJECT``</td>
            <td> Ends the object declaration.
            </td>
         </tr> 
         </table>
     
      <p>
      <li> <h4>``SURFACE...ENDSURFACE`` sections</h4>

      <p>
      <li> <h4>``LATTICE...ENDLATTICE`` sections</h4>

      <p>
      <li> <h4>``MATERIAL...ENDMATERIAL`` sections</h4>

           <p>
           For details on how to write a ``MATERIAL`` section,
           see <a href="scuff-em/reference/scuffEMMaterials#Parsed">here.</a>
    </ul>

    <p>
    <!----%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%---->

    <!---------------------------------------------------------------------->
    <!---------------------------------------------------------------------->
    <!---------------------------------------------------------------------->
    <p>
    <h2><a name="Examples"></a> 5. A compendium of sample ``.scuffgeo`` files
    </h2>
    <hr>

    <p>
    The images corresponding to the ``.scuffgeo`` files below were 
    obtained using the ``scuff-analyze`` utility distributed with 
    the [[scuff-em]] suite, like this:

    <p>
    <pre class="listing">
 scuff-analyze --geometry MyGeometry.scuffgeo --WriteGMSHFiles
    </pre>

    <p>
    This produces a [[gmsh]] post-processing file 
    named ``MyGeometry.pp`` that you can open in 
    [[gmsh]] to visualize your geometry and
    make sure [[scuff-em]] interpreted your 
    ``.scuffgeo`` file as you intended.
    This is generally a good thing to do before launching any serious
    calculations.
    
    <p>
    <a name="SingleSphere"></a>
    <h3 align="center">A single perfectly electrically conducting (PEC) sphere</h3>

    <p>
    This is perhaps the simplest imaginable [[scuff-em]]
    geometry.

    <p>
    <table align="center" border="1">
    <tr>
      <th> The geometry</th>
      <th> The ``.scuffgeo`` file </th>
    </tr>
    <tr>
      <td>
      <img src="scuff-em/reference/GeometryExamples/Sphere.png"></a>
      </td>
     <!---------------------------------------------------->
      <td>
      <pre class="Listing">
 OBJECT PECSphere 
     MESHFILE Sphere.msh
 ENDOBJECT 
      </pre>
      </td>
    <tr>
    </table>
 
    <p>
    <br>
    <p>
    <hr width="75%">
    <p>
    <br>
    
    <p>
    <a name="TwoSpheres"></a>
    <h3 align="center">A gold sphere and a silicon sphere</h3>

    <p>
    This example illustrates the use of the ``DISPLACED``
    keyword to displace a surface mesh relative to its positioning 
    in the mesh file. Note in particular that this keyword allows
    us to use the same mesh file to describe two different spheres,
    which speeds things up by allowing [[scuff-em]] 
    to reuse certain parts of the calculation, thus eliminating
    redundant numerical work. (Without the ``DISPLACED`` 
    keyword in this example, the two spheres would be sitting on 
    top of one another.)

    <p>
    <table align="center" border="1">
    <tr>
      <th> The geometry</th>
      <th> The ``.scuffgeo`` file </th>
    </tr>
    <tr>
      <td>
      <img src="scuff-em/reference/GeometryExamples/TwoSpheres.png"></a>
      </td>
     <!---------------------------------------------------->
      <td>
      <pre class="Listing">

 MATERIAL SILICON
     epsf = 1.035;      # \epsilon_infinity
     eps0 = 11.87;      # \epsilon_0 
     wp = 6.6e15;       # \plasmon frequency
     Eps(w) = epsf + (eps0-epsf)/(1-(w/wp)^2);
 ENDMATERIAL

 MATERIAL GOLD
     wp = 1.37e16; 
     gamma = 5.32e13;
     Eps(w) = 1 - wp^2 / (w * (w + i*gamma));
 ENDMATERIAL

 MESHPATH /home/homer/work/MeshFiles

 OBJECT GoldSphere
     MESHFILE Sphere.msh
     MATERIAL Gold
     DISPLACED 0 0 3
 ENDOBJECT 

 OBJECT SiliconSphere
     MESHFILE Sphere.msh
     MATERIAL Silicon
 ENDOBJECT 
      </pre>
      </td>
    <tr>
    </table>
 
    <p>
    <hr width="75%">

    <p>
    <a name="NestedSpheres"></a>
    <h3 align="center">A small gold sphere inside a larger silicon dioxide sphere</h3>

    <p>
    <table align="center" border="1">
    <tr>
      <th> The geometry</th>
      <th> The ``.scuffgeo`` file </th>
    </tr>
    <tr>
      <td>
      <a href=scuff-em/scuff-scatter/SphericalShell.png>
      <img src="scuff-em/scuff-scatter/SphericalShell.png"></a>
      </td>
     <!---------------------------------------------------->
      <td>
      <pre class="Listing">
 # material specification for intrinsic silicon
 MATERIAL SILICON
     epsf = 1.035;      # \epsilon_infinity
     eps0 = 11.87;      # \epsilon_0 
     wp = 6.6e15;       # \plasmon frequency
     Eps(w) = epsf + (eps0-epsf)/(1-(w/wp)^2);
 ENDMATERIAL

 OBJECT SiliconSphere 
     MESHFILE Sphere_R1P0.msh
     MATERIAL Silicon
 ENDOBJECT 
 
 
 OBJECT InnerSphere 
     MESHFILE Sphere_R0P5.msh
     MATERIAL PEC
 ENDOBJECT 
      </pre>
      </td>
    <tr>
    </table>

    <!--#include virtual="/scuff-EM/scuffEMFooter.shtml"-->
    
    <!---------------------------------------------------------------------->
    <!-- end big table encompassing the entire page ------------------------>
    <!---------------------------------------------------------------------->
    </td>
    </table>

<!----------------------------------------------------------------------->
<!-- end main page table                                               -->
<!----------------------------------------------------------------------->
</tr></table>
   
<!----------------------------------------------------------------------->
<!-- end main page body ------------------------------------------------->
<!----------------------------------------------------------------------->
   
<!--#include virtual="/pageend.shtml"-->
