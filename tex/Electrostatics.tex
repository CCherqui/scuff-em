\documentclass[letterpaper]{article}

\input{scufftex}

\graphicspath{{figures/}}

%------------------------------------------------------------
%------------------------------------------------------------
%- Special commands for this document -----------------------
%------------------------------------------------------------
%------------------------------------------------------------

%------------------------------------------------------------
%------------------------------------------------------------
%- Document header  -----------------------------------------
%------------------------------------------------------------
%------------------------------------------------------------
\title {Pure Electrostatics in \ls}
\author {Homer Reid}
\date {May 17, 2013}


%------------------------------------------------------------
%------------------------------------------------------------
%- Start of actual document
%------------------------------------------------------------
%------------------------------------------------------------

\begin{document}
\pagestyle{myheadings}
\markright{Homer Reid: Electrostatics in \ls}
\maketitle

\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Theory}

As in the usual \ls, we imagine geometries to consist
of homogeneous regions $\{\mc R_r\}$. Homogeneous region 
$\{\mc R_r\}$ has relative dielectric permittivity 
$\epsilon_r.$ 

The boundary of $\mc R_r$ is denoted $\partial \mc R_r$; 
it may consist of a single closed surface or a union of
surfaces, each of which may be individually open.
Thus we write 
%====================================================================%
\numeq{RrSs} { \partial \mc R_r = \cup \, \mathcal{S}_s }
%====================================================================%
Each surface $\mc S_s$ bounds precisely two regions; 
thus $\mc S_s$ appears on the RHS of equation (\ref{RrSs})
for two different values of $r$. 

On each surface lives a surface charge density 
$\sigma(\vb x)$.

Surface $\mc S_s$ may optionally be PEC, in which case it
must be assigned a fixed potential $V_s$ before the problem
can be solved. Physically, a PEC surface corresponds to
an infinitesimally thin conducting layer at the interface
between two dielectric regions, and the surface charge
on such a surface represents free charges supplied to the
surface by whatever batteries initially charged them up to
their specified  potentials $V_s.$

On the other hand, a non-PEC surface simply desribes the 
interface between two dielectric regions, and the 
surface charge on such a surface represents the divergence
of the bound volume polarization density in the dielectric  
region. Among other things, this means that the total
surface charge integrated over the boundary of a dielectric
region must vanish. There is no such constraint on 
the total surface charge on PEC surfaces.

%====================================================================%
%====================================================================%
%====================================================================%
\subsection*{Potentials and fields from charge densities: 
             continuous forms} 

Let $\vb x$ be a point in a region $\mc R_r$. The electrostatic potential 
and field at $\vb x$ are obtained by summing contributions from
surface charges on all surfaces bounding $\mc R_r$: 
%====================================================================%
\begin{subequations}
\begin{align}
\phi(\vb x) 
&= \phi_r\sups{ext}(\vb x) 
  +\frac{1}{4\pi\epsilon_0} 
   \oint
   \frac{1}{|\vb x - \vb x^\prime|}
           \,\sigma(\vb x^\prime) \, d\vb x^\prime
\\
%--------------------------------------------------------------------%
\vb E(\vb x) 
&= \vb E_r\sups{ext}(\vb x)
  +\frac{1}{4\pi\epsilon_0}
   \oint
   \frac{(\vb x-\vb x^\prime)}
        {|\vb x - \vb x^\prime|^3}
        \,\sigma(\vb x^\prime)\,d\vb x^\prime
\end{align}
\label{ContinuousEquations1}
\end{subequations}
%====================================================================%
where the integrals are over all surfaces in the problem\footnote{Note
that the integrals in (\ref{ContinuousEquations1}) are over 
\textit{all} surfaces in the problem, not just the surfaces bounding 
the region in which the evaluation point lies. This is in contrast
to the full-wave case, in which the corresponding surface integrals
range only over the surfaces bounding the medium in question.}
and where $\phi_r\sups{ext},\vb E_r\sups{ext}$ are the potential
and field arising from external field sources lying inside
region $\mc R_r.$\footnote{In a BEM scattering problem these 
would be the ``incident'' fields, but in an electrostatic problem 
the word ``incident'' doesn't quite make sense, so we call them 
the ``external'' fields instead.}

%====================================================================%
%====================================================================%
%====================================================================%
\subsection*{Surface charge density expansion}

Now imagine approximating all surfaces as unions 
of flat triangular panels, 
$$ \mc S_{s} = \cup \, \mc P_{sn}$$
Let $P_{sn}$ have area $A_{sn}$ and surface normal
$\vbhat{n}_{sn}$. (We will worry about the direction
of $\vbhat{n}_{sn}$ later.)

To panel $\mc P_{sn}$ we assign a scalar-valued 
``pulse'' basis function $b_{sn}(\vb x)$ that is 
1 on the panel and 0 elsewhere:
$$ b_{sn}(\vb x) = 
   \begin{cases}
    1, \qquad &\vb x \in \mc P_{sn} \\
    0, \qquad &\text{otherwise}.
  \end{cases}
$$
We approximate the surface charge density on $\mc S_s$
as an expansion in the $b_{sn}$ functions:
$$ \frac{\sigma(\vb x)}{\epsilon_0} 
   \approx \sum_n \sigma_{sn} b_{sn}(\vb x)
   \qquad 
   \text{for }\vb x\in \mc S_s.
$$
Note that my $\sigma_{sn}$ unknowns have the dimensions
of 
$$\frac{\text{surface charge density}}{\text{permittivity}}=
  \frac{\text{volts}}{\text{length}}.
$$

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Potentials and fields from charge densities: 
             discretized forms} 

The electrostatic potential and field at $\vb x$ are 
%====================================================================%
\begin{subequations}
\begin{align}
\phi(\vb x) 
&= \phi_r\sups{ext}(\vb x)
   +
   \sum_{n} \sigma_n 
   \int_{\mc P_n} \frac{d\vb x^\prime}{4\pi |\vb x - \vb x^\prime|}
\\
%--------------------------------------------------------------------%
\vb E(\vb x) 
&= \vb E_r\sups{ext}(\vb x)
   +
   \sum_{n} \sigma_n 
   \int_{\mc P_n} \frac{(\vb x-\vb x^\prime)d\vb x^\prime}
                       {4\pi |\vb x - \vb x^\prime|^3}
\end{align}
\label{DiscreteEquations1}
\end{subequations}
where the sum is over all panels on all surfaces in the problem.
%====================================================================%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Conditions on potentials and fields}

\subsubsection*{Conditions at PEC surfaces}

At PEC surfaces we impose the condition that the electrostatic
potential equal the specified potential for that conductor:
%====================================================================%
\begin{align}
 \phi(\vb x) &= V_s, \qquad \text{for } \vb x \in \mc S_s.
\nonumber
\intertext{Galerkin-testing with the expansion functions for 
           surface $\mc S_s$, we find }
 \int_{\mc P_{sm}} \phi(\vb x) d\vb x &= A_{sm} V_s,
 \qquad \text{for all panels $\mc P_{sm}$ on surface }\mc S_m.
\nonumber
 \intertext{Inserting (\ref{DiscreteEquations1}a), this reads }
 \sum_{n} \mathcal{I}\supt{(1)}_{mn} \sigma_n
 &= A_{sm} V_s - \int_{\mc P_m} \phi\sups{ext}(\vb x)d\vb x
\label{PECPanelEquation}
\end{align}
where
$$ \mathcal{I}\supt{(1)}_{mn} 
   \equiv 
   \int_{\mc P_m} \int_{\mc P_n} 
   \frac{1}{4\pi|\vb x - \vb x^\prime|} \, d\vb x^\prime \,d\vb x.
$$ 
%====================================================================%

\subsubsection*{Conditions at dielectric surfaces}

At non-PEC surfaces we impose the condition that the normal 
electric field exhibit the requisite discontinuity. 
If $\vb x$ is a point on a surface $\mc S_s$ lying between
regions $\mc R_a$ and $\mc R_b$, the condition is 
\numeq{EFieldDiscontinuity}
{
 \epsilon_a \left|\pard{\phi}{\vbhat{n}}\right|_{\vb x^+}
=
 \epsilon_b \left|\pard{\phi}{\vbhat{n}}\right|_{\vb x^-}
}
where $\vbhat{n}$ is the surface normal pointing 
away from $\mc R_b$ into $\mc R_a$, and 
where $x^+$ and $x^-$ are points lying
infinitesimally displaced from $\vb x$ along
$\vbhat{n}$ into $\mc R_a$ and $\mc R_b$.

When we seek to enforce condition (\ref{EFieldDiscontinuity}) 
at a point $\vb x$ lying within a panel $\mc P_{sm}$
on $\mc S_s$, we find the following dichotomy:
%====================================================================%
\begin{enumerate}
  \item Surface charges on $\mc P_{sm}$ contribute to 
        the two sides of (\ref{EFieldDiscontinuity})
        with \textit{opposite} signs.
  \item Surface charges on all other panels, as well as the 
        external field soures, contribute
        to the two sides of (\ref{EFieldDiscontinuity})
        with the \textit{same} sign.
\end{enumerate}
%====================================================================%
\begin{align*}
&\epsilon_a 
   \left[ \frac{\sigma_m}{2} 
          + \sum_{n\ne m} \sigma_n \int_{\mc P_{n}}
            \frac{ \vbhat{n}_m \cdot (\vb x-\vb x^\prime)}
                 { 4\pi |\vb x-\vb x^\prime|^3 } \, d\vb x^\prime
          + \vbhat{n}_m \cdot \vb E\sups{ext}(\vb x)
   \right]
\\
&\qquad
=\epsilon_b 
   \left[  -\frac{\sigma_m}{2} 
          + \sum_{n\ne m} \sigma_n \int_{\mc P_{n}}
            \frac{ \vbhat{n}_m \cdot (\vb x-\vb x^\prime)}
                 { 4\pi |\vb x-\vb x^\prime|^3 } \, d\vb x^\prime
          + \vbhat{n}_m \cdot \vb E\sups{ext}(\vb x)
   \right]
\end{align*}
or 
\numeq{DielectricCondition}
{ \sigma_m 
  + \Delta_{ab}
    \sum_{n\ne m} \sigma_n \int_{\mc P_{n}}
    \frac{ \vbhat{n}_m \cdot (\vb x-\vb x^\prime)}
         { 4\pi |\vb x-\vb x^\prime|^3 } \, d\vb x^\prime
   = -\Delta_{ab}\vbhat{n}_m \cdot \vb E\sups{ext}(\vb x)
}
with
$$\Delta_{ab} = 2\frac{\epsilon_a-\epsilon_b}{\epsilon_a + \epsilon_b}.$$
Now Galerkin-test (\ref{DielectricCondition}) with the pulse basis
function associated with panel $m$:
\numeq{DielectricPanelEquation}
{
   A_{m} \sigma_m 
   + \Delta_{ab} \sum_{n\ne m} \mathcal{I}\sups{(2)}_{mn} \sigma_n
   = -\Delta_{ab} \int_{\mc P_m} \vbhat{n}_m \cdot \vb E\sups{ext}(\vb x) d\vb x
}
where 
$$ \mathcal{I}\supt{(2)}_{mn} 
   \equiv 
   \int_{\mc P_m} \int_{\mc P_n} 
   \frac{\vbhat{n}_m \cdot (\vb x-\vb x^\prime)}
        {4\pi|\vb x - \vb x^\prime|^3} \, d\vb x^\prime \,d\vb x.
$$ 

\subsubsection*{BEM system}

Assembling equations (\ref{PECPanelEquation}) for all PEC panels
and (\ref{DielectricPanelEquation}) for all dielectric panels 
into a big linear system, we have 
%====================================================================%
\numeq{BEMSystem}{ \vb M \boldsymbol{\sigma} = \vb v }
%====================================================================%
where the $m$th entry of the unknown vector $\sigma$ is the 
surface charge density (divided by $\epsilon_0$) on the $m$th
panel, and where the elements of the BEM matrix and the RHS vector are
%====================================================================%
\paragraph{If panel $m$ is PEC:}
$$ M_{mn} = \mathcal{I}\sups{(1)}_{mn}, 
   \qquad 
   v_m = A_{m} V_s - \int_{\mc P_m} \phi\sups{ext}(\vb x) \, d\vb x
$$
\paragraph{If panel $m$ is dielectric:}
$$ M_{mn} = 
   \begin{cases} 
     A_m, \qquad &m=n \\
     \Delta_{ab} \mathcal{I}\sups{(2)}_{mn}, \qquad &m\ne n
   \end{cases} 
   \qquad 
   v_m = -\Delta_{ab} \int_{\mc P_m} \vbhat{n}_m \cdot \vb E\sups{ext}(\vb x) \, d\vb x.
$$
%====================================================================%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Fields of individual panels}

\begin{align*}
 \phi(\vb x) &= \sum_n \sigma_n \mathbb{P}_n(\vb x) \\
 \vb E(\vb x) &= \sum_n \sigma_n \mathbb{E}_n(\vb x) \\
\end{align*}

$$ \vb x^\prime = V_0 + u\vb A + v\vb B $$
%====================================================================%
$$ \vb x - \vb x^\prime = u\vb A + v\vb B + (\vb V_0 - \vb x) $$
%====================================================================%
$$ |\vb x - \vb x^\prime|^2 = 
    C_{20} u^2 + C_{11} uv + C_{02} v^2 + 
    C_{10} u + C_{01} v + C_{00}
$$
%====================================================================%
$$
\begin{array}{cclcccl}
  C_{20} &=& |\vb A|^2 
  &\qquad &
  C_{02} &=& |\vb B|^2 
\\
  C_{11} &=& 2\vb A \cdot \vb B
  &\qquad &
  C_{10} &=& 2\vb A \cdot (\vb V_0-\vb x)
\\
  C_{01} &=& 2\vb B \cdot (\vb V_0-\vb x)
  &\qquad &
  C_{00} &=& |\vb V_0-\vb x|^2
\end{array}
$$
%====================================================================%
It is convenient to write the distance between points in the form
$$ |\vb x - \vb x^\prime|^2 =
    C_{02} \Big[ (v+v_0)^2 + \xi^2 \Big]
$$
where
$$ v_0=\frac{1}{2}\big(C_{11}^\prime u + C_{01}^\prime\big), 
   \qquad
   \xi^2 = \Big[ C_{20}^\prime - \frac{1}{4}C_{11}^{\prime 2} \Big]u^2
          +\Big[ C_{10}^\prime - \frac{1}{2}C_{11}^{\prime}C_{01}^\prime\Big]u
          +\Big[ C_{00}^\prime - \frac{1}{4}C_{01}^{\prime 2}\Big]
$$
with the shorthand
$$C_{ij}^\prime = \frac{C_{ij}}{C_{02}}.$$
Then we have
%====================================================================%
%====================================================================%
\begin{align*}
 \mathbb{P}_n(\vb x) &= 
 \int_{\mc P_n} \frac{d\vb x^\prime}{|\vb x-\vb x^\prime|}
\\
&=
 \int_0^1 du \, \int_0^u \, dv 
    \frac{1}
         {\sqrt{ C_{20}u^2 + C_{11}uv + C_{02}v^2 + C_{10}u + C_{01}v + C_{00}}}
\intertext{Substitute $v=u\alpha, dv=ud\alpha:$}
&=
 \int_0^1 du \, \int_0^1 \, d\alpha
    \frac{u}
         {\sqrt{  \Big(C_{20}+C_{11}\alpha+C_{02}\alpha^2\Big)u^2
                 +\Big(C_{10}+C_{01}\alpha\Big)u + C_{00}}} 
\intertext{Evaluate the $u$ integral:}
 \int_0^1 du \, \int_0^u \, dv 
\end{align*}
%====================================================================%

\end{document}
