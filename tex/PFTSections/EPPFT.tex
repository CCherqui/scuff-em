%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Equivalence-principle PFT (EPPFT)}

In the EPPFT approach, we compute the power, force and torque
on a body by considering the work done on, and the force and 
torque exerted on, the equivalent surface currents flowing on 
the body surface.

The power may be computed as the Joule heating of the
$\vb K$ and $\vb N$ currents by the $\vb E$ and $\vb H$ fields:
%====================================================================%
\begin{subequations}
\begin{equation}
 P\sups{abs} 
     = \frac{1}{2}\text{ Re }
      \int_{\partial \mc B} \Big[ \vb K^*(\vb x) \cdot \vb E(\vb x)
                                 +\vb N^*(\vb x) \cdot \vb H(\vb x)
                            \Big] \, dA
\end{equation}
%====================================================================%
The force may be computed by summing the Lorentz forces on the charges 
and currents in each infinitesimal surface patch $dA$:
%====================================================================%
\begin{equation}
 F_i  = \frac{1}{2}\text{ Re }
      \int_{\partial \mc B} 
 \bigg\{   \sigma\subt{E}^*\, \vb E_i(\vb x)
         +Z_0\big(\vb K^* \times \vb H\big)_{i}
         +\sigma\subt{M}^*\, \vb H_i(\vb x)
         -\frac{1}{Z_0}\big(\vb N^* \times \vb E\big)_{i}
 \bigg\}
\end{equation}
\label{EPPFTContinuous}
\end{subequations}
where the electric and magnetic charge densities are
%====================================================================%
$$ \sigma\subt{E} \equiv \frac{\nabla \cdot \vb K}{i\omega \epsilon}, 
   \qquad
   \sigma\subt{M} \equiv \frac{\epsilon \nabla \cdot \vb N}{i\omega}.
$$
%====================================================================%

\subsection*{Implementation in {\sc scuff-em}}

Recall that the $\vb E$ and $\vb H$ fields due to a set of
RWG basis functions $\{\vb b_\alpha(\vb x)\}$ populated
with electric and magnetic surface-current weights 
$\vb k_\alpha, \vb n_\alpha$ are 
%====================================================================%
\begin{align*}
\vb E(\vb x) 
 &= \sum_{\alpha} \Big( ikZ k_\alpha \vb e_\alpha(\vb x)
                        -n_\alpha \vb h_\alpha(\vb x)
                  \Big)
\\
\vb H(\vb x) 
 &= \sum_{\alpha} \Big( k_\alpha \vb h_\alpha(\vb x)
                        +\frac{ik}{Z} n_\alpha \vb e_\alpha(\vb x)
                  \Big)
\end{align*}
%====================================================================%
where $k=\sqrt{\epsilon \mu}\cdot \omega$ is the wavenumber in the relevant
medium, $Z=Z_0Z^r$ with $Z^r=\sqrt{\mu/\epsilon}$ the relative wave impedance,
and $\vb e_\alpha, \vb h_\alpha$ are the ``reduced fields'' of basis
function $\vb b_\alpha:$
%====================================================================%
$$
 \vb e_\alpha(\vb x) = \vb a_\alpha(\vb x) + \frac{1}{k^2}\nabla p_\alpha(\vb x),
 \qquad
 \vb h_\alpha(\vb x) = \nabla \times \vb a_\alpha(\vb x)
$$
with $\vb a$ and $p$ the ``reduced'' vector and scalar potentials
of $\vb b_\alpha,$
%====================================================================%
$$
 \vb a_\alpha(\vb x) 
 = 
 \int G(\vb x-\vb x^\prime) \vb b_\alpha(\vb x^\prime) d\vb x^\prime 
\qquad
 p_\alpha(\vb x) 
 = 2\int G(\vb x-\vb x^\prime) d\vb x^\prime 
$$
%====================================================================%
where the integrals are over the supports of $\vb b_\alpha$
and $G(\vb r)=\frac{e^{ik|\vb r|}}{4\pi|\vb r|}$ is the 
scalar Green's function in the medium.

An important subtlety that affects the EPPFT calculation is
that the fields in (\ref{EPPFTContinuous}) are evaluated
on the surface of the body.

In terms of the surface-current coefficients, the absorbed power
reads 
%====================================================================%
\begin{align*}
 P\sups{abs} 
&= \frac{1}{2}\text{Re }\sum_{\alpha\beta}
   k^*_\alpha \Big[  ikZ  k_\beta\inp{\vb b_\alpha}{\vb e_\beta}
                         -n_\beta\inp{\vb b_\alpha}{\vb h_\beta}
              \Big]
+
   n^*_\alpha \Big[   k_\beta\inp{\vb b_\alpha}{\vb h_\beta}
                    + \frac{ik}{Z} n_\beta\inp{\vb b_\alpha}{\vb e_\beta}
              \Big]
\\
 &= \text{Re }\sum_{\alpha\beta}
    \left(
     \begin{array}{c}
      k_\alpha \\[5pt]
      n_\alpha
     \end{array}
    \right) ^\dagger
%--------------------------------------------------------------------%
    \left(\begin{array}{cc}
     P\supt{EE}_{\alpha\beta} & 
     P\supt{EM}_{\alpha\beta} \\[5pt]
     P\supt{ME}_{\alpha\beta} &
     P\supt{MM}_{\alpha\beta}
     \end{array}
    \right)
%--------------------------------------------------------------------%
    \left(
     \begin{array}{c}
      k_\alpha \\[5pt]
      n_\alpha
     \end{array}
    \right)
\end{align*}
%====================================================================%
$$\begin{array}{lclclcl}
 \displaystyle{
 P\supt{EE}_{\alpha\beta}
              }
 &=&
 \displaystyle{
 \frac{ikZ}{2} \inp{\vb b_\alpha}{\vb e_\beta}
              }
%--------------------------------------------------------------------%
 &\qquad&
%--------------------------------------------------------------------%
 \displaystyle{
 P\supt{EM}_{\alpha\beta}
              }
 &=&
%--------------------------------------------------------------------%
 \displaystyle{
 -\frac{1}{2}\inp{\vb b_\alpha}{\vb h_\beta}
              }
\\[8pt]
%--------------------------------------------------------------------%
 \displaystyle{
 P\supt{EM}_{\beta\alpha}
              }
 &=&
 \displaystyle{
 +\frac{1}{2}\inp{\vb b_\alpha}{\vb h_\beta}
              }
%--------------------------------------------------------------------%
 &\quad& 
%--------------------------------------------------------------------%
 P\supt{MM}_{\beta\alpha}
 &=&
 \displaystyle{
 +\frac{ik}{2Z}\inp{\vb b_\alpha}{\vb e_\beta}
              }
\end{array}$$
%====================================================================%
In terms of the surface-current coefficients, the $i$-directed force reads 
\begin{align*}
 F_i
= \frac{1}{2}\text{Re }\sum_{\alpha\beta}
 \bigg\{&
   k^*_\alpha\pf{1}{i\omega \epsilon}^*
    \Big[ ikZ k_\beta \inp{\nabla \cdot \vb b_\alpha}{\vb e_{\beta i}}
             -n_\beta  \inp{\nabla \cdot \vb b_\alpha}{\vb h_{\beta i}}
    \Big]
\\
&+ Z_0 k^*_\alpha
    \Big[ k_\beta \big\langle \vb b_\alpha \times \vb h_\beta\big\rangle_i
         +\frac{ik}{Z} n_\beta \big\langle \vb b_\alpha \times \vb e_\beta\big\rangle_i
    \Big]
\\
&+
   n^*_\alpha\pf{\epsilon}{i\omega}^*
    \Big[ k_\beta \inp{\nabla \cdot \vb b_\alpha}{\vb h_{\beta i}}
         +\frac{ik}{Z} +n_\beta \inp{\nabla \cdot \vb b_\alpha}{\vb e_{\beta i}}
    \Big]
\\
&- \frac{1}{Z_0} n^*_\alpha
    \Big[ ikZ k_\beta \big\langle \vb b_\alpha \times \vb e_\beta\big\rangle_i
          -n_\beta \big\langle \vb b_\alpha \times \vb h_\beta\big\rangle_i
    \Big] \bigg\}.
\end{align*}
%====================================================================%
or 
%====================================================================%
$$
 F_i
  = \text{Re }\sum_{\alpha\beta}
    \left(
     \begin{array}{c}
      k_\alpha \\[5pt]
      n_\alpha
     \end{array}
    \right) ^\dagger
%--------------------------------------------------------------------%
    \left(\begin{array}{cc}
     F\supt{EE}_{\alpha\beta} & 
     F\supt{EM}_{\alpha\beta} \\[5pt]
     F\supt{ME}_{\alpha\beta} &
     F\supt{MM}_{\alpha\beta}
     \end{array}
    \right)
%--------------------------------------------------------------------%
    \left(
     \begin{array}{c}
      k_\alpha \\[5pt]
      n_\alpha
     \end{array}
    \right)
$$
%====================================================================%
\begin{align*}
 F\supt{EE}_{\alpha\beta}
 &=
 -\pf{1}{2\omega \text{Re }\epsilon}
  kZ \inp{\nabla \cdot b_\alpha}{\vb e_{\beta i}}
               +Z_0  \big\langle \vb b_\alpha \times \vb h_\beta\big\rangle_i 
\\
%--------------------------------------------------------------------%
 F\supt{EM}_{\alpha\beta}
 &=
 +\frac{1}{2\omega \text{Re }\epsilon}
  \frac{kZ}{2\omega} \inp{\nabla \cdot b_\alpha}{\vb h_{\beta i}}
               +Z_0  \big\langle \vb b_\alpha \times \vb h_\beta\big\rangle_i 
\\
\end{align*}
